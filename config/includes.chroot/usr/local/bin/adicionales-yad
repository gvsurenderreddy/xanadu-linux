#!/bin/bash
#elaborado por sinfallas
echo $BASHPID > /run/adicionales-yad.pid
source /usr/local/bin/variables
mio=$(yad --sticky --fixed --center --width=360 --height=420 --no-click --list --title="Adicionales" --column=Acciones "Activar Seguridad" "Antivirus" "Iniciar Tor" "Monitor Tor" "Detener Tor" "Iniciar i2p" "Detener i2p" "Como activar la persistencia" "Reparar Hora" "Iniciar Compton" & echo "$!" > /run/adicionales-menu.pid)

if [ "$mio" = "Activar Seguridad|" ]; then
	seguridad_1
	yad --timeout=7 --skip-taskbar --button=ACEPTAR:1 --title="ADVERTENCIA" --fixed --center --text-align=fill --borders=6 --text="Los servicios: shorewall, fail2ban y psad se activaran durante el arranque con sus configuraciones por defecto (aumentara dramáticamente el consumo de recursos en su equipo,), es necesario que el usuario las modifique de acuerdo a sus necesidades, presione aceptar para continuar." & echo "$!" > /run/adicionales-sub.pid
	source $0

elif [ "$mio" = "Antivirus|" ]; then
	yad --timeout=5 --skip-taskbar --button=ACEPTAR:1 --title="ADVERTENCIA" --fixed --center --text-align=fill --borders=6 --text="La actualización de base de firmas de virus retardara el inicio, por favor espere, presione aceptar para continuar." & echo "$!" > /run/adicionales-sub.pid
	antivirus_1

elif [ "$mio" = "Iniciar Tor|" ]; then
	if [[ -f $lock ]]; then
		yad --timeout=3 --skip-taskbar --button=ACEPTAR:1 --title="ERROR" --fixed --center --text-align=fill --borders=6 --text="Tor ya se esta ejecutando." & echo "$!" > /run/adicionales-sub.pid
		source $0
	else
    		tor_1
		yad --timeout=3 --skip-taskbar --button=ACEPTAR:1 --title="ADVERTENCIA" --fixed --center --text-align=fill --borders=6 --text="Espere mientras se inicia TOR se le notificara al completarse la tarea." & echo "$!" > /run/adicionales-sub.pid
		espera
		yad --timeout=10 --skip-taskbar --button=ACEPTAR:1 --title="FINALIZADO" --fixed --center --text-align=fill --borders=6 --text="Inicio completado. Si utiliza un navegador diferente de Iceweasel, introduzca la siguiente configuración de PROXY en su navegador: localhost (o el ip del equipo) puerto 8118 (9151 para socks) y localhost (o el ip del equipo) puerto 9050 para las otras aplicaciones que usen socks." & echo "$!" > /run/adicionales-sub.pid
		iceweasel https://check.torproject.org/
	fi

elif [ "$mio" = "Monitor Tor|" ]; then
	lxterminal -e sudo -u debian-tor arm
	source $0

elif [ "$mio" = "Detener Tor|" ]; then
	if [[ -f $lock ]]; then
		tor_0
		yad --timeout=3 --skip-taskbar --button=ACEPTAR:1 --title="FINALIZADO" --fixed --center --text-align=fill --borders=6 --text="Servicio finalizado exitosamente." & echo "$!" > /run/adicionales-sub.pid
	else
		yad --timeout=3 --skip-taskbar --button=ACEPTAR:1 --title="ERROR" --fixed --center --text-align=fill --borders=6 --text="Tor no se esta ejecutando." & echo "$!" > /run/adicionales-sub.pid
		source $0
	fi

elif [ "$mio" = "Iniciar i2p|" ]; then
	yad --timeout=3 --skip-taskbar --button=ACEPTAR:1 --title="ADVERTENCIA" --fixed --center --text-align=fill --borders=6 --text="Esta función es experimental y no se garantiza su correcto funcionamiento." & echo "$!" > /run/adicionales-sub.pid
	if [[ -f $lock ]]; then
		yad --timeout=3 --skip-taskbar --button=ACEPTAR:1 --title="ERROR" --fixed --center --text-align=fill --borders=6 --text="I2p no puede ejecutarse conjuntamente con tor." & echo "$!" > /run/adicionales-sub.pid
		source $0
	else
		if [[ -f $lock2 ]]; then
			yad --timeout=3 --skip-taskbar --button=ACEPTAR:1 --title="ERROR" --fixed --center --text-align=fill --borders=6 --text="I2p ya se esta ejecutando." & echo "$!" > /run/adicionales-sub.pid
			source $0
		else
    			i2p_1
		fi
	fi

elif [ "$mio" = "Detener i2p|" ]; then
	if [[ -f $lock2 ]]; then
		i2p_0
		yad --timeout=3 --skip-taskbar --button=ACEPTAR:1 --title="FINALIZADO" --fixed --center --text-align=fill --borders=6 --text="Servicio finalizado exitosamente." & echo "$!" > /run/adicionales-sub.pid
	else
		yad --timeout=3 --skip-taskbar --button=ACEPTAR:1 --title="ERROR" --fixed --center --text-align=fill --borders=6 --text="I2p no se esta ejecutando." & echo "$!" > /run/adicionales-sub.pid
		source $0
	fi

elif [ "$mio" = "Como activar la persistencia|" ]; then
	zenity --text-info --title="Persistencia" --filename=$persistencia 
	source $0

elif [ "$mio" = "Reparar Hora|" ]; then
	yad --skip-taskbar --button=ACEPTAR:1 --title="ADVERTENCIA" --fixed --center --text-align=fill --borders=6 --text="Esta opción tratara de reparar la forma en la que se muestra la hora en su ordenador." & echo "$!" > /run/adicionales-sub.pid
	hora_1
	source $0

elif [ "$mio" = "Iniciar Compton|" ]; then
	if yad --skip-taskbar --title="ADVERTENCIA" --fixed --center --text-align=fill --borders=6 --text="Esta opción activara el gestor de composición compton aumentando dramáticamente el consumo de recursos en su equipo, ¿desea continuar?." & echo "$!" > /run/adicionales-sub.pid; then
		compton_1
	else
		source $0
	fi	
	
	
else
rm -f /run/adicionales-sub.pid
rm -f /run/adicionales-menu.pid
rm -f /run/adicionales-yad.pid
exit 0

fi
rm -f /run/adicionales-sub.pid
rm -f /run/adicionales-menu.pid
rm -f /run/adicionales-yad.pid
exit 0
